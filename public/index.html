<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Parkour Collab</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
  </head>

  <body>
    <div id="homeScreen" class="home-screen">
      <div class="column">
        <div class="box info-box">
          <h2>Welcome!</h2>
          <ul>
            <li>This is an app to collaborate on bonk.io parkour maps.</li>
            <li>Draw lines on a shared canvas.</li>
            <li>
              To copy the final map, use the
              <a
                class="info-link"
                href="https://github.com/elder-tubby/bonkio-parkour-generator/blob/main/browser-script/pkrGenerator.js"
                target="_blank"
              >
                pkrGenerator mod <span>&#x2197;</span>
              </a>
              .
            </li>
            <li>
              The map data is also compatible with the
              <a
                class="info-link"
                href="https://www.youtube.com/playlist?list=PLo8kHyDWLzW3DWnnWw2IHE1C17TSGQWiv"
                target="_blank"
              >
                parkour generator app <span>&#x2197;</span>
              </a>
              .
            </li>
            <li>
              All code is available on elder-tubby's
              <a
                class="info-link"
                href="https://github.com/elder-tubby"
                target="_blank"
              >
                GitHub <span>&#x2197;</span>
              </a>
              .
            </li>
          </ul>
        </div>
      </div>

      <div class="column">
        <div class="box controls-box">
          <input
            type="text"
            id="usernameInput"
            placeholder="Your username"
            autocomplete="off"
            maxlength="26"
          />
          <button id="joinBtn" class="btn">Set Name</button>
          <div class="inline-check">
            <input type="checkbox" id="readyCheckbox" />
            <label for="readyCheckbox">Ready</label>
          </div>
          <p id="lobbyMessage" class="lobby-message">
            Drawing will start when 2 players are ready.
          </p>
        </div>

        <div class="box">
          <h3>Lobby Players</h3>
          <ul id="readyList" class="lobby-list"></ul>
        </div>
      </div>
    </div>

    <div id="canvasWrapper" class="hidden">
      <div class="main-panel">
        <div class="sidebar">
          <div class="box">
            <h3>Players</h3>
            <ul class="player-list" id="playerList"></ul>
          </div>
          <div class="box">
            <div class="votes-grid">
              <label for="voteCheckbox">Vote to finish</label>
              <input type="checkbox" id="voteCheckbox" />
              <div id="voteStatus">0 / 0 voted</div>
              <div></div>
              <label for="hideUsernamesCheckbox">Hide tags (H)</label>
              <input type="checkbox" id="hideUsernamesCheckbox" />
            </div>
            <div class="copy-map-row">
              <button id="copyMapBtn" class="btn btn-small">
                Copy map data
              </button>
            </div>
            <div class="copy-map-row">
              <button id="autoGenerateBtn" class="btn btn-small">
                Generate shapes
              </button>
            </div>
          </div>
          <div class="box">
            <h3>Hotkeys</h3>
            <ul class="tips-list">
              <li>
                <strong>SHIFT + MOUSE</strong>
                <span class="hotkey-desc">â€“ Line selection</span>
              </li>
              <li>
                <strong>M</strong>
                <span class="hotkey-desc">â€“ Toggle polygon/line</span>
              </li>
              <li>
                <strong>B</strong> <span class="hotkey-desc">â€“ Bouncy</span>
              </li>
              <li>
                <strong>D</strong> <span class="hotkey-desc">- Death</span>
              </li>
              <li>
                <strong>N</strong> <span class="hotkey-desc">â€“ Non-bouncy</span>
              </li>
              <li>
                <strong>X</strong> <span class="hotkey-desc">â€“ Delete</span>
              </li>
              <li>
                <strong>Arrow keys</strong>
                <span class="hotkey-desc">â€“ Move line</span>
              </li>
              <li>
                <strong>CTRL Z</strong>
                <span class="hotkey-desc">â€“ Delete last line</span>
              </li>
              <li>
                <strong>CTRL A</strong>
                <span class="hotkey-desc">â€“ Select all</span>
              </li>
              <li>
                <strong>CTRL C</strong>
                <span class="hotkey-desc">â€“ Copy map</span>
              </li>
              <li>
                <strong>CTRL V</strong>
                <span class="hotkey-desc">â€“ Paste map</span>
              </li>
              <li>
                <strong>[ ]</strong>
                <span class="hotkey-desc">â€“ Move to back/front</span>
              </li>
            </ul>
          </div>
          <div class="box hidden" id="adminPanel">
              </div>
          </div>
        </div>

        <div class="canvas-area">
          <div class="canvas-frame">
            <canvas id="canvas" width="750" height="500"></canvas>
            <div class="control-box"></div>
          </div>
        </div>

        <div class="chat-box">
          <h3>Chat</h3>
          <div id="chatMessages"></div>
          <input
            type="text"
            id="chatInput"
            placeholder="Press Enter to start typing..."
            autocomplete="off"
          />
          <div class="chat-actions">
            <button id="chatSendBtn" class="btn btn-small">Send</button>
            <button
              id="chatAudioBtn"
              class="btn btn-icon"
              title="Toggle chat sound"
            >
              ðŸ”Š
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="gameEndPopup" class="popup-overlay hidden" aria-hidden="true">
      <div class="popup-box">
        <button id="popup-close" class="popup-close" aria-label="Close">
          Ã—
        </button>
        <h2>Game ended</h2>
        <p>Would you like to copy map data?</p>
        <div class="popup-actions">
          <button id="copyLineInfoBtn" class="btn">Copy map data</button>
        </div>
      </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/poly-decomp@0.3.0/build/decomp.min.js"></script>
    <script type="module" src="app.js"></script>
  </body>
</html>
